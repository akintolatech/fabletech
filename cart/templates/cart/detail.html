{% extends "webcms/base.html" %}
{% load static %}

{% block title %}
  Your shopping cart
{% endblock %}

{% block content %}

      <!-- section -->
      <div class="section">

        <h1>
    
          {% with total_items=cart|length %}
            {% if total_items > 0 %}
              Your shopping cart
              <a href="{% url 'cart:cart_detail' %}">
                {{ total_items }} item{{ total_items|pluralize }},
                ${{ cart.get_total_price }}
              </a>
            {% elif not order %}
              Your cart is empty.
            {% endif %}
          {% endwith %}
      
        </h1>

        <div class="shop-container for-cart">

            

          <div class="container-of-containers">

                <div class="cart-item-container">

                  {% for item in cart %}
                    {% with product=item.product %}
              
                      <div class="cart-item-card">
              
                        <div class="cart-img-details">
              
                            <div class="cart-item-img-box">
                                <a href="{{ product.get_absolute_url }}">
                                  <img src="{% if product.image %}{{ product.image.url }}
                                  {% else %}{% static 'img/no_image.png' %}{% endif %}">
                                </a>
                            </div>
                            
                            <div class="cart-item-details">
                                <p>{{ product.name }}</p>
                                <p style="margin: 0;">${{ item.total_price }}</p>
                                <!-- ${{ item.price }} @  -->
                            </div>
                        </div>
              
                        <div class="cart-qty-control">
              
                          <div class="qty-control-card">
              
                              <form action="{% url 'cart:cart_add' product.id %}" method="post" class="update-qty">
                                {{ item.update_quantity_form.quantity }}
                                {{ item.update_quantity_form.override }}
                                <input type=image src="{% static 'img/icons/addcircle.svg' %}" alt="Submit feedback">
                                {% csrf_token %}
                              </form>
              
                          </div>
              
                            <div class="qty-control-card">
                                <form action="{% url 'cart:cart_remove' product.id %}" method="post">
                                  <input type="image" src="{% static 'img/icons/delete.svg' %}" value="Remove" >
                                  {% csrf_token %}
                                </form>
                            </div>
              
                
                          
                
              
                        </div>
              
                      </div>
                      
                    {% endwith %}
                  {% endfor %}
 
                </div>

            </div>

          <div class="aside-container">

              <!-- <h4>Categories</h4> -->

              <div class="user-profile">

                  <!-- Categories -->
                  <div class="user-func">
                      <div class="icon-and-text">
                          <div class="func-icon"><img src="{% static 'img/icons/verified.svg' %}"></div>
                          <h4>Order Summary</h4>
                      </div>
                      <!-- <h4>(3)</h4> -->
                  </div>

              </div>

              <ul>
                {% for item in cart %}
                  <li>
                    {{ item.quantity }}x {{ item.product.name }}
                    <span>${{ item.total_price }}</span>
                  </li>
                {% endfor %}
              </ul>
              <p>Total: ${{ cart.get_total_price }}</p>

              <!-- <div class="related-products-container">
                  <h4>Best Deals</h4>

                  <div class="user-func">
                      <div class="icon-and-text">
                          <div class="func-icon"><img src="../img/burger.png"></div>
                          <h4>Small Chops</h4>
                      </div>
                      <h4>(3)</h4>
                  </div>

                  <div class="foodtab">

                      <div class="foodimg">
                          <img src="../img/shawarma.png"/>
                      </div>
                      <div class="foodtext">
                          <h4>Chicken Sharwarma</h4>
                          <p>$300</p>
                      </div>

                  </div>
                  <div class="foodtab">

                      <div class="foodimg">
                          <img src="../img/shawarma.png"/>
                      </div>
                      <div class="foodtext">
                          <h4>Chicken Sharwarma</h4>
                          <p>$300</p>
                      </div>

                  </div>
              </div> -->


          </div>

        </div>

    </div>




  <p class="text-right">
    <a href="{% url 'shop:product_list' %}" class="button
    light">Continue shopping</a>

  </p>

  <a href="{% url 'orders:order_create' %}" class="button">
  Checkout
  </a>
{% endblock %}
